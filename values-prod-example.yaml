# Example production values for Visual Regression Tracker
# Copy this file and customize it for your environment
# DO NOT commit this file with sensitive data to git!

namespace: vrt

global:
  domain: vrt.example.com
  protocol: https

api:
  replicaCount: 3
  image:
    tag: "5.0.8"
  
  resources:
    requests:
      cpu: 300m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi
  
  secrets:
    jwtSecret: "CHANGE_THIS_TO_STRONG_SECRET_MIN_32_CHARS"
    postgresPassword: "CHANGE_THIS_TO_STRONG_PASSWORD_MIN_16_CHARS"
    awsAccessKeyId: ""
    awsSecretAccessKey: ""

ui:
  replicaCount: 3
  image:
    tag: "5.0.8"
  
  resources:
    requests:
      cpu: 150m
      memory: 256Mi
    limits:
      cpu: 300m
      memory: 512Mi
  
  env:
    REACT_APP_API_URL: "https://vrt.example.com/api"

postgres:
  persistence:
    enabled: true
    size: 50Gi
    storageClass: "standard-rwo"  # Change to your storage class

storage:
  imageUploads:
    enabled: true
    size: 100Gi
    accessMode: ReadWriteMany
    storageClass: "nfs-storage"  # Change to your NFS storage class with RWX support

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
  
  hosts:
    - host: vrt.example.com
      paths:
        - path: /
          pathType: Prefix
          backend: ui
        - path: /api
          pathType: Prefix
          backend: api
        - path: /static
          pathType: Prefix
          backend: ui
  
  tls:
    enabled: true
    secretName: vrt-tls

# LDAP Integration (optional)
ldap:
  enabled: false
  url: "ldap://ldap.example.com:389"
  bindUser: "cn=admin,dc=example,dc=com"
  bindPassword: "CHANGE_ME"
  searchDN: "ou=users,dc=example,dc=com"
  searchFilter: "(uid={{username}})"
  attributeFirstName: givenName
  attributeLastName: sn
  attributeMail: mail

# AWS S3 Integration (optional, for image storage)
awsS3:
  enabled: false
  region: "us-east-1"
  bucket: "vrt-images-prod"
  accessKeyId: "CHANGE_ME"
  secretAccessKey: "CHANGE_ME"

# Elasticsearch for logging (optional)
elasticsearch:
  enabled: false
  url: "http://elasticsearch.logging.svc.cluster.local:9200"

# Pod disruption budget for high availability
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Network policies
networkPolicy:
  enabled: false

# Affinity for pod scheduling
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app
                operator: In
                values:
                  - vrt-api
                  - vrt-ui
          topologyKey: kubernetes.io/hostname
